#!/usr/bin/env node
var js = require('../').create();

var util = require('util');
var readline = require('readline');

var rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});
rl.setPrompt('> ');
rl.prompt();

var buffer = '';

rl.on('line', function(line) {
  try {
    var val = js.compile(buffer + line).call().cast();
  } catch (e) {
    if (!/Unexpected/.test(e.message))
      throw e;

    rl.setPrompt('... ');
    rl.prompt();

    buffer += line;
    return;
  }
  console.log(util.inspect(val.toJSON(), false, null, true));

  buffer = '';
  rl.setPrompt('> ');
  rl.prompt();
});
